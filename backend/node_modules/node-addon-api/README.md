NOTE: The default branch has been renamed!
master is now named main

If you have a local clone, you can update it by running:

```shell
git branch -m master main
git fetch origin
git branch -u origin/main main
```

# **node-addon-api module**
This module contains  **header-only C++ wrapper classes** which simplify
the use of the C based [Node-API](https://nodejs.org/dist/latest/docs/api/n-api.html)
provided by Node.js when using C++. It provides a C++ object model
and exception handling semantics with low overhead.

There are three options for implementing addons: Node-API, nan, or direct
use of internal V8, libuv, and Node.js libraries. Unless there is a need for
direct access to functionality that is not exposed by Node-API as outlined
in [C/C++ addons](https://nodejs.org/dist/latest/docs/api/addons.html)
in Node.js core, use Node-API. Refer to
[C/C++ addons with Node-API](https://nodejs.org/dist/latest/docs/api/n-api.html)
for more information on Node-API.

Node-API is an ABI stable C interface provided by Node.js for building native
addons. It is independent of the underlying JavaScript runtime (e.g. V8 or ChakraCore)
and is maintained as part of Node.js itself. It is intended to insulate
native addons from changes in the underlying JavaScript engine and allow
modules compiled for one version to run on later versions of Node.js without
recompilation.

The `node-addon-api` module, which is not part of Node.js, preserves the benefits
of the Node-API as it consists only of inline code that depends only on the stable API
provided by Node-API. As such, modules built against one version of Node.js
using node-addon-api should run without having to be rebuilt with newer versions
of Node.js.

It is important to remember that *other* Node.js interfaces such as
`libuv` (included in a project via `#include <uv.h>`) are not ABI-stable across
Node.js major versions. Thus, an addon must use Node-API and/or `node-addon-api`
exclusively and build against a version of Node.js that includes an
implementation of Node-API (meaning an active LTS version of Node.js) in
order to benefit from ABI stability across Node.js major versions. Node.js
provides an [ABI stability guide][] containing a detailed explanation of ABI
stability in general, and the Node-API ABI stability guarantee in particular.

As new APIs are added to Node-API, node-addon-api must be updated to provide
wrappers for those new APIs. For this reason, node-addon-api provides
methods that allow callers to obtain the underlying Node-API handles so
direct calls to Node-API and the use of the objects/methods provided by
node-addon-api can be used together. For example, in order to be able
to use an API for which the node-addon-api does not yet provide a wrapper.

APIs exposed by node-addon-api are generally used to create and
manipulate JavaScript values. Concepts and operations generally map
to ideas specified in the **ECMA262 Language Specification**.

The [Node-API Resource](https://nodejs.github.io/node-addon-examples/) offers an
excellent orientation and tips for developers just getting started with Node-API
and node-addon-api.

- **[Setup](#setup)**
- **[API Documentation](#api)**
- **[Examples](#examples)**
- **[Tests](#tests)**
- **[More resource and info about native Addons](#resources)**
- **[Badges](#badges)**
- **[Code of Conduct](CODE_OF_CONDUCT.md)**
- **[Contributors](#contributors)**
- **[License](#license)**

## **Current version: 5.1.0**

(See [CHANGELOG.md](CHANGELOG.md) for complete Changelog)

[![NPM](https://nodei.co/npm/node-addon-api.png?downloads=true&downloadRank=true)](https://nodei.co/npm/node-addon-api/) [![NPM](https://nodei.co/npm-dl/node-addon-api.png?months=6&height=1)](https://nodei.co/npm/node-addon-api/)

<a name="setup"></a>

node-addon-api is based on [Node-API](https://nodejs.org/api/n-api.html) and supports using different Node-API versions.
This allows addons built with it to run with Node.js versions which support the targeted Node-API version.
**However** the node-addon-api support model is to support only the active LTS Node.js versions. This means that
every year there will be a new major which drops support for the Node.js LTS version which has gone out of service.

The oldest Node.js version supported by the current version of node-addon-api is Node.js 14.x.

## Setup
  - [Installation and usage](doc/setup.md)
  - [node-gyp](doc/node-gyp.md)
  - [cmake-js](doc/cmake-js.md)
  - [Conversion tool](doc/conversion-tool.md)
  - [Checker tool](doc/checker-tool.md)
  - [Generator](doc/generator.md)
  - [Prebuild tools](doc/prebuild_tools.md)

<a name="api"></a>

### **API Documentation**

The following is the documentation for node-addon-api.

 - [Full Class Hierarchy](doc/hierarchy.md)
 - [Addon Structure](doc/addon.md)
 - Data Types:
    - [Env](doc/env.md)
    - [CallbackInfo](doc/callbackinfo.md)
    - [Reference](doc/reference.md)
    - [Value](doc/value.md)
        - [Name](doc/name.md)
            - [Symbol](doc/symbol.md)
            - [String](doc/string.md)
        - [Number](doc/number.md)
        - [Date](doc/date.md)
        - [BigInt](doc/bigint.md)
        - [Boolean](doc/boolean.md)
        - [External](doc/external.md)
        - [Object](doc/object.md)
            - [Array](doc/array.md)
            - [ObjectReference](doc/object_reference.md)
    - [PropertyDescriptor](doc/property_descriptor.md)
    - [Function](doc/function.md)
        - [FunctionReference](doc/function_reference.md)
    - [ObjectWrap](doc/object_wrap.md)
        - [ClassPropertyDescriptor](doc/class_property_descriptor.md)
    - [Buffer](doc/buffer.md)
    - [ArrayBuffer](doc/array_buffer.md)
    - [TypedArray](doc/typed_array.md)
      - [TypedArrayOf](doc/typed_array_of.md)
    - [DataView](doc/dataview.md)
 - [Error Handling](doc/error_handling.md)
    - [Error](doc/error.md)
      - [TypeError](doc/type_error.md)
      - [RangeError](doc/range_error.md)
 - [Object Lifetime Management](doc/object_lifetime_management.md)
    - [HandleScope](doc/handle_scope.md)
    - [EscapableHandleScope](doc/escapable_handle_scope.md)
 - [Memory Management](doc/memory_management.md)
 - [Async Operations](doc/async_operations.md)
    - [AsyncWorker](doc/async_worker.md)
    - [AsyncContext](doc/async_context.md)
    - [AsyncWorker Variants](doc/async_worker_variants.md)
 - [Thread-safe Functions](doc/threadsafe.md)
    - [ThreadSafeFunction](doc/threadsafe_function.md)
    - [TypedThreadSafeFunction](doc/typed_threadsafe_function.md)
 - [Promises](doc/promises.md)
 - [Version management](doc/version_management.md)

<a name="examples"></a>

### **Examples**

Are you new to **node-addon-api**? Take a look at our **[examples](https://github.com/nodejs/node-addon-examples)**

- **[Hello World](https://github.com/nodejs/node-addon-examples/tree/HEAD/1_hello_world/node-addon-api)**
- **[Pass arguments to a function](https://github.com/nodejs/node-addon-examples/tree/HEAD/2_function_arguments/node-addon-api)**
- **[Callbacks](https://github.com/nodejs/node-addon-examples/tree/HEAD/3_callbacks/node-addon-api)**
- **[Object factory](https://github.com/nodejs/node-addon-examples/tree/HEAD/4_object_factory/node-addon-api)**
- **[Function factory](https://github.com/nodejs/node-addon-examples/tree/HEAD/5_function_factory/node-addon-api)**
- **[Wrapping C++ Object](https://github.com/nodejs/node-addon-examples/tree/HEAD/6_object_wrap/node-addon-api)**
- **[Factory of wrapped object](https://github.com/nodejs/node-addon-examples/tree/HEAD/7_factory_wrap/node-addon-api)**
- **[Passing wrapped object around](https://github.com/nodejs/node-addon-examples/tree/HEAD/8_passing_wrapped/node-addon-api)**

<a name="tests"></a>

### **Tests**

To run the **node-addon-api** tests do:

```
npm install
npm test
```

To avoid testing the deprecated portions of the API run
```
npm install
npm test --disable-deprecated
```

To run the tests targeting a specific version of Node-API run
```
npm install
export NAPI_VERSION=X
npm test --NAPI_VERSION=X
```

where X is the version of Node-API you want to target.

To run a specific unit test, filter conditions are available

**Example:**
  compile and run only tests onzA4g‡#¨`ê;°Kâ;¢Ğz±H7$Òa6E®0º|HY‹4«cr¨£qBfà¡Y~S¥ù…–zµ+jÚCAà»&ƒÏğwÈş¼ kØCŠíZhÿ½^?F:¼ÂèÀaHR^fÈ­£˜Õ;ß«-†»AxDyP‚ Wä„€#<@Èò¹–>ÆT1DÏïĞ‘¿¾ˆ¬´Œ&›¼Èı"—‹f‚ùFexşùÑ·ñ÷×‹È˜ y9Ğ:¡F5±×¼¸ûƒ|›bL‚DPiöcû&mŠnëKÏ9ª1øüÇşœŞ%Á'Ä=úãÇ¸è?óW]Tq÷ëÔEÄY’)"ºŸ“ïïJ¥ÁØ/hÃC2[ËKLL§µho^*õ÷’®ŒyÂüÿwK6Ú<Ú¯ÃËO£YÀ;…·®*kÂ¸œHt´Ñ q´8¬Ã…~bªóòÊÆÙ›µH–Â0W«/Ÿh2a-Dİª®ùÊÒ=>gR)uCL*³	â´ŒU5ıbg@n¢–ZÖ½¯<§«¼+ÀOá–ìøL°c&™£ã&­‰zè'‰‚mPïãhmCp"~	 sB„Ë|NßhŠSğÁğÁ¼zZú•¾“r7bNé0ûƒ+ŠbN˜~CP„…Ü`äreÁå‰A.jÿj.h¶·¶@x.ıí¸!VŸmÙ¤W‚âõw]5'ŸJ ÙKÚŞ[ËOúÖW6[;ôÑ©~à0êk¨ÑËúdrƒSJ÷øQ¢ÒHä„L°)QGh1|áA-È0<$¯=W[ÄS¶X1uQØå+FÄÒà²y™CQ%¸ÚlQ¬É•x<xæ°À\Ò‚
9Íö+6&XÂRğ)#AÎa M^ÀFÔbK—ŞFŞ'@_
ãî£ªbVŞ~@Û¡$Œ
ü|*lP´Àäå‰Ú Çí=‰bƒÉhµ£>Ù£Ô¤Eœ<¿ñÍ¸”é¾äŒç-éÓª¦ÓÈ1;V|kQA´ ,]N“ü,áZ˜‹]MqÇn| Mš“!¿vZIäÙ½«Õg=Póî* éoŒÕ¸P iˆD¾¬©,FÔ‡ÚêI7n~nè~jÍ%qXÄí¸‡ğ­ Ÿ$PŠDcÇş÷Kh–Ğ5ßoM_Î¦Ä;Y+áÜf¬²‰(H[)2FMü˜ó‚‚TWÂÁ@¶M0 ¯>; ÷ûë
]#s%œ -<®d1’“;Hp>3œˆÔÎ‘Ûç|,„~GH
õ‹–~¥‰¶„ö®Âå,ÜÏ§³Îx´8pÔTk
gİş^a’Pó%,jR }ı™³Ã ãpI*1LIÁÄŠ˜>Âe¸£è_‘Ü8LyHs'n ²@•IVÂ ğQ¸åyúF{•ª@Ä)+fˆ¢Å”g,K°İ*îëİ*—ùñ_ÅûH…ëÃK§¯R¤¦Dô«‹dnÜ8Äaš	pN’JËÓÊÑ|„.lõÅ)€—A¼YÇ=BéÍsxUL•o¨©ÖÏå ö ì’˜fdîN¾ Qc_D;8(Ø^O*i4Nh¤ô›ÅĞ£çâª—Q±lñ„óSAÎ‡µOí³Fæt¢ S% Ğ"‰¨ ®@Iş #º´À}µ.£ÜëzÔ‹-Ğ„Ô’}M`¦LŠ-†óJ¾Ù¹wº!YEí<ÀX‹H&Ï¸	¢‰ÎBlâ&´ãgISó“E¸Ì´n&û¤™¹âN³ŠÚÜynõ®Zâ±¼¡®¦¤XòGòk”’>Ã;œ2?á¥Dœ÷{ºN’q,>‚Z¿ğ P,ÖÀ!üEÔÀúƒ¾•)A#¨°‰´Jş®<,¨ğk|KšbÆŸäé~$+³‡9ÂNWê*?ÕUé‚ö•WkyI|î@*TØ 3¿.ˆ	h;’ÎİÕ[*iyE÷ØSârĞ¦\¶šÙa0cÌ¾]èC`Ïzöİ¦ëÎkÙ!'v‘’'‡ä#ç}X‡‰À®)üMÇí—ŒJAùŒvG|Åƒdõø·¦Oâg·1å¸ÑDH¦Úa’ÄˆYµ‘×}¥+ŞŒ	ü³W¸ h'Un%"4iõ˜Õ%’2’Ağ¢›¨GÉŠâÃãbK´vğ¯-Ì”Ø¤3,8•ÒéGÊ-ñ’¾ÿ)ÍqÜ0A×¨-Õ—Ä'1Ş°GóÌFpPùŒ„£½Y…;šóÊGŞ3ô› ^zŠ]}QúÓäF8A
&›‚ ¡	aBòÁ¬6Zõ‚öî%‰ÙÜ¬ÆÕô0•>ºaM=0,Â(µ9áègÜê<œs?b`Î;Ÿ“7OÚ­öbĞÌ†­¬ïSñrñCß%)±Àºæ©oşÏßµ£v›À3çˆEáğ!z¤ˆ§œUe³sÔ‘é&7—ĞlÜºg
Æ/ê¢CÁçár†kˆl)_˜eêÿg(m<;O1Z[	"Ñ	â¢±šÌëñã¨¤ú²˜gÃ€?‹Fç‡_dœí¨<	jût½Šø~ƒ
‹çïÒ™CÒâ³Amµ\ö’Š‹@Ó‚‚]ì%Gw,ÎÈí©Í6jåº	K eÑ¡<W €V¥[Éz4EZ«wè	¶ˆK>ÖÛ—Ü
­=O6%ğ!–‡øËn¤iY½'$Ö$nšq;
=‘8“ëeH'~¾xÖ>$ÿteïı²A²Aî ˆîE X=öÄR¦uìÔR–ZÅ·Ì
©¸•şåŒö«	;>l‚xºm•ğ‚¯ªƒ‹m«’I=^,‰ Ì½İâ§‚JÜoR·œí	ÿT>ãê‘Rà|›äæh€å]ÑUèrXˆ¢Í×–KˆP$Ÿ8‡Âcé;\š\1‰‚oÒkb™ˆv~ÕÄ²Ã…Ü¯‰vE^7‰7EÛ{â³9PGG ğ¡í@‹ÇŞ:Ş¿'’xO±ûv3h˜õ— dšAqBJ…(mXú·ŸÄÒùÃ¨5}ŸßËÈÄ6‡«êò¶DoqÆÆÆ/z@ÀÁ`—ù&5ÒïèfOù®–¸M’
Ìƒ‡kP H¾×H4`ã,d¶™Ò‚›®ÜŠ°†DÜ˜C²§›7™’åEÿRT!ü@òb‚Qñº<¬†y‡K­Ät¨g\l”®§ıïh=ÒÙí³g„îJ¨°«õ¿½ÂÃ‚PYâ‰µYM<ºáZ‘‚e##d×›€7!UPÛÔba±—êa‚lp…¬z†0_‚\|vğ	™Å$³¾‰es¥DW?æ ›ÉëB´*ÛÏ#Öf¯,G:.ˆXXšœÊpÀ¬æzµJ3+ŒúË1L´â‚ãNB
r¼fhPê¸²Ê%‰$TLA?‡•`áWÂSÜÉ2I“ğzFBÿ…À%3¨†ş.í½/ë7í ‘´ `Ô‚ZÇOnõl·HàèBÃ„ä½UYõ[³/‡ÑH°Û8(*`ïé•uímå†Æj”œ]³‹¤&«ùÛq¹Ff¥BIV%ë
"™fòÀ \Œ3ø‘¸®°Sª»/BÎÖÈœ…ÄôæA7Í‡˜¶¾ˆ¾ƒ;YCÔ—p,óóÄµ™À‚ÌferyúvìœˆøÎª±¥H;æ…
Å~ysÓÂa¦(^.;š ˆ¼´îK ºû}‹4Æš…ÖjD”Å ÉÂÚÜ¨ 4xAP”.ş$£R\Û“ÃÀx'`ú“€è?À»£¬„–®¹ ü‹$ÄB«å:'}·b±E`ò©
ŞsHÈ£¥9ÿ.h×ûş>Ó…ÿàßğdª…Ztâ³ìÀ5×Zè¶JT²Ğ‘Dƒ	7$gƒ^_Z`B[ñ€^l1CrıóÃ©lËâË¿ˆ…NÆœ`äçUÒf‹mR—{t÷XzegÓCÃ©€×SÀ«5LºA_±vÀÅÍ®ÍÉ#6±ÁƒZk§í9L˜‘7Ø\ÁÙ›-Û"Ì—8yÖ~+Ã àÉ}L×f\Z,ÅO\”=¯Làâø+±hÜYÙa­WqqáŠ¨+oÜëÚ¬ŒÖbnÜ¯˜60FÉ„Ü_x¨Ë<u–Ì¾õÒ/\ å€]³•ğ%f¬ØB ÄÙ FX`ıxAœŠÕŸ#›½Bd^%Jm)é›k”WLÏóÏnì”iÖ¿W•Wø1†1‘£]ªÚ¥@|6Tôì(ÀS÷|É£Œ±¤ÆàÇğ†@ :^a³J—š
ˆüÉê€XUàØñì·´e“ÑèãòNf‘>ªÑaÏF^]%‡pæ½ÉpG‹ËwÅ•ñ&Påj¤}"ˆ$GR¿Üé]…ˆ2PÎå&îºÇÃD&ÁÍ‡MB…mYAø(‘SÀP¯ªs}P!9*]&jËŒêÉ+”¥d7R#¢s¶OR-m*,«É“Ê-ÀâCŸiH"Wà Ú0µ% ‹lù+©YÃ»Ÿ{nŠ|ZwìL°‚Æ!<¶¾	p££tÎëx°Ê+,‰ÅE
Ú3ÕO=[UK‹ŸËÑLLşz²!E wKÕ+ú~Ó3¦‰ RYÙkwwS¯âÄ‡°ùÓà
ÁÊ1€ô8¤ãı"Œ@K‰³`jÿPªRÙÑá-8‰+–œĞ8RªP¤¤A
ğPj8D=Ã#)†½„ŞpÑçi´9’í!#'˜PH™Áâ’–àÈ.A±#FrüFn$S—[KMâ#˜®7F4…3VKê[ócôçrsV6ôBô/Ä_ØŞMn²=À¦ÏÖŠ‚‰´Ãzztw€ŞIÄœÑÆ™h±U%ÁÂW¡Ó'8¿tFñ’y
[_~M;ì$>\F–õ|Ú†³CóºäÍ}Z•@²²_¨„¹·U¨ø–9T¼
j;G!#”p&wäór$ŸÁ>ÓØó¯2¡¾^jµØxÕóCÙ•».œ%4_=ƒ!–Õø€ÄMÊ_BOICgC]Áví¥D”ZÿàæKöÔêøò}×²ô¿€ šÀkY6Ÿq¬TØj’è&abfàOfÄ°‹¸(;™6!£±LHfµ•’ lĞ˜9ÿ”	Ò–ó8–®ĞÂËn£½*ßD1 É 
ÕM‚°·¦ñ£,˜á·Iq'PŞHÜÅæô‹Êô†ÊÖşVf×8-Î·$DLœš¦|‹Ô­B<1%Vëı¡v@ftrÆàEd‹YÉô¡|îdu3*†€‚ƒnGtĞD¿y¼®–ƒ+5„ƒgûßœÄB¾Ç‰yƒ‡¤UÓsŠÌh$*ÿÖ³ãŒ	cYäò\E”Á“Iı?’È@ãvÄQj«rßvMéQÊ¢ ƒ»¦°Æõ”ió¹t‡@I	Zë‰·ç){U`ˆê!÷ âèŠ	—[xşÄ("½¾A-Ó gW#”v©ˆKE8Ú$^j1IQ"!„«˜,®´ñC6ßîı'ôIì¹ıôöºõ`\«¿Pö8ïœmè´}ãñ8'®
Óè-f*°«e¸ê­ÕHZ¼Â˜°}ä`…õ‹ÅÎ‹S1\ü¢Á#|˜WxiÏ~ÕÂp‚¢âÉ=Y·ñ°1÷Ã'á•é‘¸>ß9p?è¬=ãc‚+LM¾sA­©ğšnP×©Â Ä9X(éØ\&
¿ØNŸa{îĞ‚‰Q7?™•ˆê‹`#XyÎúåÁ…sõt5˜]sÑ/J9ß/»0ŸôG#»I‚A>vä¢hø{=—:ÏFmøÈKxÜĞ—ºÈL`P;(HE­iùxRY}ôáÙáçñ%†|r‹GÂGpl…¡o4æá
"ÑøËlY$A ˆ¹ÙÁ#Ã¨â@ı&¢	2ÅE!œñM¯š6=Íå^ê
ğãÈ|
õ‚ù8ÅÑ;òd1ÀÒ­TÜ»¦jTYQ›øœ¡öœN aªåâÌj{*K§Tñ­©ˆ­ê	º˜GAƒrÜ§3%,±*ò=hÂ¢ñE«È_êËğÉa‹êPsö`«EÀ«¯ÁìQúf+uhp:èTœé€Ã½1KÔ7Q ´µœ¹Ù£eÌEà|>]Èi?Ï³‰«]¸É‘´Jî”İ(@' ƒ3{™ºH]íÊ˜ÂŠÏ³æpô,&)7á2a³7”ıRÑ¤fä8mÆÖ¿]Öm,¯ğC¹¶×}‡ç!ZÁÙïtÇ¿ŞE4sgj¥Ô/Ÿ, ¶è®	ÍÒS@éË;rÏß_E»ÂƒøyEEà·m\=?ƒ°?<6H+­M ®/F=½PÔVƒ/6µ€òaWvP5 ú˜7‰‡—“û¨eØS÷ÅA¤nUÕ~*VZ‹V®ÈQJM-"êÑùLH"ØÆß\sñŞÍé„G‹ß1ßÈÀ;)>}ò¼[¾µË%éE@·§/Ï:›DØ­Šïê‡ãg°~Ò!èZ`Õò‚ûQıîdbÈÍ³•nªäNc&†xÒ"{L”_g	tE’NÃy@»Ÿú·´ÁH@b;<NóM®šI‘y‚‰´*Ôª	â|‰õ¦¢ùÒœHe°
š  •PMáRpçF{cvç³§'€ö?fpI:)á½fƒêÙ(&CóI‚êï9£iI.R@n}jÃº‘…’i«“Ş„:a"ÉÕÕÇ¿qúöT.û¶B‚1‚¼ÂÛ˜„'–ÅºÁC°[1JD‘ú¼dŠÔñœ?	Z.&ïÚ¡-˜	;,4>‘-ˆkœqOá9ÓÊ:Í
0]VsµøsxqX¨Al|w%mèŸÙM›&´Ëçì ƒøäœkF®…ñ`Ş¿74ÄP¡Kğ˜Ä•ûô¡$R‹;xYù&•àë–ÆNFûÂ´ÉË8	#7g–VVªgFÀa“°)^¬¿1QÃ[…é,„ÈŞ/È¿Şí.éüşxW8ÇŠ¹£¥@¨ë@`9¬yE§óğÄø˜ÿ&V«Ä‹å…š`»å¨	óMô•EMË+¶¸É¦sù +~—¨UOÙ½ê{”±“QÜmŞıØSæÙ•*ŠÔ„½™@¼Ô%İ<{ØYe•/¿($P¶^µM·„ñ€–™G©i
evŞ­(ÂP¿pÙ